Домашнее задание к занятию "3.7 Компьютерные сети (лекция 2)"  

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?  

В linux: ifconfig  (image 1-1.png)  

vagrant@vagrant:~$ ifconfig  
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500  
        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255  
        inet6 fe80::a00:27ff:fe64:75a1  prefixlen 64  scopeid 0x20<link>  
        ether 08:00:27:64:75:a1  txqueuelen 1000  (Ethernet)  
        RX packets 671  bytes 86754 (86.7 KB)  
        RX errors 0  dropped 0  overruns 0  frame 0  
        TX packets 495  bytes 86753 (86.7 KB)  
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0  

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536  
        inet 127.0.0.1  netmask 255.0.0.0  
        inet6 ::1  prefixlen 128  scopeid 0x10<host>  
        loop  txqueuelen 1000  (Local Loopback)  
        RX packets 1626  bytes 84124 (84.1 KB)  
        RX errors 0  dropped 0  overruns 0  frame 0  
        TX packets 1626  bytes 84124 (84.1 KB)  
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0  

В Windows: ipconfig  (image 1-2.png)  

C:\Users\sergo>ipconfig  

Настройка протокола IP для Windows  

Адаптер Ethernet Ethernet:  

   DNS-суффикс подключения . . . . . :  
   Локальный IPv6-адрес канала . . . : fe80::baa0:1ff5:2c3d:35e7%8  
   IPv4-адрес. . . . . . . . . . . . : 192.168.0.14  
   Маска подсети . . . . . . . . . . : 255.255.255.0  
   Основной шлюз. . . . . . . . . : 192.168.0.1  

Адаптер Ethernet Ethernet 2:  

   DNS-суффикс подключения . . . . . :  
   Локальный IPv6-адрес канала . . . : fe80::9e4e:b73c:4ded:392d%16  
   IPv4-адрес. . . . . . . . . . . . : 192.168.56.1  
   Маска подсети . . . . . . . . . . : 255.255.255.0  
   Основной шлюз. . . . . . . . . :  

Адаптер Ethernet Сетевое подключение Bluetooth:  

   Состояние среды. . . . . . . . : Среда передачи недоступна.  
   DNS-суффикс подключения . . . . . :  
   
2. Какой протокол используется для распознавания соседа по сетевому интерфейсу?   

Link Layer Discovery Protocol (LLDP) — протокол канального уровня, позволяющий сетевому оборудованию оповещать локальную сеть о своем существовании и характеристиках, а также собирать такие же оповещения, поступающие от соседнего оборудования. Протокол формально утвержден как IEEE standard 802.1AB-2009, в сентябре 2009 года, и является независимой от производителей сетевого оборудования заменой их патентованным протоколам, таким как Cisco Discovery Protocol, Extreme Discovery Protocol, Foundry Discovery Protocol и Nortel Discovery Protocol (последний также известен как SONMP).  

Какой пакет и команды есть в Linux для этого? (image 2.png)    

vagrant@vagrant:~$ sudo apt install lldpd  

vagrant@vagrant:~$ lldpcli show neighbors  
-------------------------------------------------------------------------------  
LLDP neighbors:  
-------------------------------------------------------------------------------  
vagrant@vagrant:~$   

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей?  Приведите пример конфига.  

Технология VLAN (Virtual Local Area Network) позволяет создавать и гибко конфигурировать виртуальные сети поверх физической. Это позволяет реализовывать достаточно сложные сетевые конфигурации.  

Какой пакет и команды есть в Linux для этого?   

vagrant@vagrant:~$ sudo apt install vlan  

Приведите пример конфига.  

Чтобы информация о созданных VLAN'ах сохранилась после перезагрузки, необходимо добавить её в файл /etc/network/interfaces.  

Название vlan может быть как vlan100, vlan200 и т.д., так и вида eth0.999. Отличие будет лишь в их название в виде интерфейсов.  (image 3.png)  

vagrant@vagrant:~$ sudo nano /etc/network/interfaces  

auto vlan1400  
iface vlan1400 inet static  
        address 192.168.1.1  
        netmask 255.255.255.0  
        vlan_raw_device eth0  

auto vlan333  
iface vlan333 inet static  
        address 10.0.1.2  
        netmask 255.255.255.0  
        vlan_raw_device eth0  

auto eth0.999  
iface eth0.999 inet static  
        address 10.100.10.3  
        netmask 255.255.255.0  
        vlan_raw_device eth0  

4. Какие типы агрегации интерфейсов есть в Linux?    

В Linux существуют Team и Bonding.  

Какие опции есть для балансировки нагрузки?  

mode=0 (balance-rr)  
Последовательно кидает пакеты, с первого по последний интерфейс.  
mode=1 (active-backup)  
Один из интерфейсов активен. Если активный интерфейс выходит из строя (link down и т.д.), другой интерфейс заменяет активный. Не требует дополнительной настройки коммутатора  
mode=2 (balance-xor)  
Передачи распределяются между интерфейсами на основе формулы ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. Один и тот же интерфейс работает с определённым получателем. Режим даёт балансировку нагрузки и отказоустойчивость.  
mode=3 (broadcast)  
Все пакеты на все интерфейсы  
mode=4 (802.3ad)  
Link Agregation — IEEE 802.3ad, требует от коммутатора настройки.  
mode=5 (balance-tlb)  
Входящие пакеты принимаются только активным сетевым интерфейсом, исходящий распределяется в зависимости от текущей загрузки каждого интерфейса. Не требует настройки коммутатора.  
mode=6 (balance-alb)  
Тоже самое что 5, только входящий трафик тоже распределяется между интерфейсами. Не требует настройки коммутатора, но интерфейсы должны уметь изменять MAC.  

Приведите пример конфига.  (image 4.png)  

vagrant@vagrant:~$ sudo nano /etc/network/interfaces  

auto bond0  
iface bond0 inet static  
        address 10.0.1.5  
        netmask 255.255.255.0  
        network 10.0.1.0  
        gateway 10.0.1.254  
        bond_mode balance-tlb  
        bond_miimon 100  
        bond_downdelay 200  
        bond_updelay 200  
        slaves eth0 eth1  

5. Сколько IP адресов в сети с маской /29 ?   

Всего 8 адресов, из них 6 можно использовать (с 1 по 6)  

192.168.0.0/29	Маска /29 или 255.255.255.248  
192.168.0.1  
192.168.0.6  
Широковещательный адрес	192.168.0.7	  

 Сколько /29 подсетей можно получить из сети с маской /24.   
 
 В /24 сети 256 адресов. если я правильно понял, то всего можно получить 32  /29 подсетей, т.к. на каждую подсеть выделяется по 8 адресов.  
 
 
 Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.   

10.10.10.1/29  
10.10.10.2/29  
10.10.10.3/29  
10.10.10.4/29  
10.10.10.5/29  
10.10.10.6/29  

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.  

К частным адресам относятся IP-адреса из следующих подсетей:  

От 10.0.0.0 до 10.255.255.255 с маской 255.0.0.0 или /8  
От 172.16.0.0 до 172.31.255.255 с маской 255.240.0.0 или /12  
От 192.168.0.0 до 192.168.255.255 с маской 255.255.0.0 или /16  
От 100.64.0.0 до 100.127.255.255 с маской подсети 255.192.0.0 или /10; данная подсеть рекомендована согласно rfc6598 для использования в качестве адресов для CGN (Carrier-Grade NAT)  

Адреса можно взять из следующей подсети: 100.64.0.0/26   (image 6.png)   

vagrant@vagrant:~$ ipcalc 100.127.255.255/10 -s 40
Address:   100.127.255.255      01100100.01 111111.11111111.11111111  
Netmask:   255.192.0.0 = 10     11111111.11 000000.00000000.00000000  
Wildcard:  0.63.255.255         00000000.00 111111.11111111.11111111  
=>  
Network:   100.64.0.0/10        01100100.01 000000.00000000.00000000  
HostMin:   100.64.0.1           01100100.01 000000.00000000.00000001  
HostMax:   100.127.255.254      01100100.01 111111.11111111.11111110  
Broadcast: 100.127.255.255      01100100.01 111111.11111111.11111111  
Hosts/Net: 4194302               Class A  
  
1. Requested size: 40 hosts  
Netmask:   255.255.255.224 = 27 11111111.11111111.11111111.111 00000  
Network:   100.64.0.0/27        01100100.01000000.00000000.000 00000  
HostMin:   100.64.0.1           01100100.01000000.00000000.000 00001  
HostMax:   100.64.0.30          01100100.01000000.00000000.000 11110  
Broadcast: 100.64.0.31          01100100.01000000.00000000.000 11111  
Hosts/Net: 30                    Class A  
  
Needed size:  64 addresses.  
Used network: 100.64.0.0/26  
Unused:  
100.64.0.64/26  
100.64.0.128/25  
100.64.1.0/24  
100.64.2.0/23  
100.64.4.0/22  
100.64.8.0/21  
100.64.16.0/20  
100.64.32.0/19  
100.64.64.0/18  
100.64.128.0/17  
100.65.0.0/16  
100.66.0.0/15  
100.68.0.0/14  
100.72.0.0/13  
100.80.0.0/12  
100.96.0.0/11  
vagrant@vagrant:~$  

7. Как проверить ARP таблицу в Linux, Windows?  (image 7-1.png, image 7-2.png)  

Ubuntu:  
ip neigh  
ip neighbour show  
arp -n  
arp-scan --interface=eth0 --localnet  

Windows:  
arp -a  

Как очистить ARP кеш полностью?  

Ubuntu:  
ip -s -s neigh flush all  

Windows:  
netsh interface IP delete arpcache  
arp -d  

Как из ARP таблицы удалить только один нужный IP?  

Ubuntu:  
arp -d <ip-address>  

Windows:  
arp -d <ip-address>  